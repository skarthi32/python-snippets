def prepare_first_last_row_column(dataframe, partitionCols, OrderByCols):
    df = dataframe
    partitions = []
    for cols in partitionCols:
        partitions.append(col(cols))
        row_number_window = Window.partitionBy(*partitions).orderBy(*OrderByCols)
        df = df.withColumn(cols + "_order", row_number().over(row_number_window))
        first_last_row_window = Window.partitionBy(*partitions).orderBy(*OrderByCols).rowsBetween(Window.unboundedPreceding,
                                                                                            Window.unboundedFollowing)
        df = df.withColumn(cols + "_first_row", first(cols + "_order").over(first_last_row_window))
        df = df.withColumn(cols + "_last_row", last(cols + "_order").over(first_last_row_window))
        df = df.withColumn("is_first_" + cols, col(cols + "_order") == col(cols + "_first_row"))
        df = df.withColumn("is_last_" + cols, col(cols + "_order") == col(cols + "_last_row"))
        df = df.drop(cols + "_order", cols + "_first_row", cols + "_last_row")

    # df.orderBy(*OrderByCols).show(truncate=False)

    return df
